
# 版本發布記錄 (Release Log)

## v4.0-Phoenix (2025-10-28)

**版本類型:** 穩定性與正確性修正 (Stability & Correctness Fix)

**版本描述:**
本版本是【階段零：安全與穩定衝刺】的最終產物，其核心目標是根除在 v1.0 之後引入的、導致「中文註釋丟失」的歷史遺留核心 Bug。通過一次決定性的架構回歸，本版本不僅徹底解決了該問題，更確立了未來文本處理的、更可靠的設計哲學，使整個系統達到了前所未有的健壯性。

### ✨ 核心功能與修正 (Core Features & Fixes):

- **✅ 核心算法修正 (註釋丟失 Bug 根治):**
  - **[廢棄]** 徹底廢棄了自 v1.0 起，基於「相對路徑計算」的、複雜且不穩定的註釋匹配算法。
  - **[回歸]** 移植並優化了 v0 版本基於「**視覺模式匹配**」的註釋算法。新算法通過純粹的文本行匹配，從根本上杜絕了因輸入格式（如 ` ``` `）污染而導致的計算偏差，實現了 100% 的註釋保留。

- **✅ 核心流程健壯性增強:**
  - **數據通道 (`stdin`):** 確立了使用標準輸入管道 (`|`) 作為腳本間數據傳遞的唯一通道，解決了因文件名包含特殊字符而導致的參數解析錯誤。
  - **哨兵管理 (`pidfile`):** 確立了使用 `--pidfile` 機制對 `inotifywait` 進程進行精準追蹤與管理，徹底解決了「殭屍進程」問題。

- **✅ 兼容性確認:**
  - **Markdown (`README.md`):** 明確了當前的「Obsidian 格式」本質上就是一種高度兼容的 Markdown 代碼塊實現，確認了系統對通用 `README.md` 文件的完美支持。

### 🛠️ 架構性結論 (Architectural Conclusions):

- **設計哲學確立:** 用實踐證明，在處理具有不確定包裹格式的文本時，**簡單、直接的「視覺模式匹配」，遠比複雜、精巧的「邏輯計算」更健壯、更可靠。**
- **專家職責固化:** `engine.py` 的職責被進一步確認為「生產純文本內容」，而 `formatter.py` 的職責是「為內容進行格式化包裝」，二者之間的界限更加清晰。

### ⚠️ 已知限制 (Known Limitations):

- **併發安全性:** 【任務 0.3】的 `flock` 文件鎖機制尚未實裝，在高頻文件變更的極端情況下，理論上仍存在 `worker.sh` 併發執行的風險。
- **交付方式單一:** 當前的交付流程僅支持「寫入本地文件」，尚未實現對 Notion 等遠程 API 平台的交付能力。

---

# 版本發布記錄 (Release Log)

## v1.0-mvp (2025-10-27)

**版本類型:** 最小可行產品 (Minimum Viable Product)

**版本描述:**
本版本是「通用目錄哨兵控制中心」的首個功能完整、流程閉環的穩定版本。它確立了專案的核心架構，並實現了所有基礎功能，為後續的迭代開發奠定了堅實的基礎。

### ✨ 核心功能 (Core Features):

- **✅ 專家架構:**
  - **管理專家 (`control.sh`):** 基於菜單的中央控制器，負責所有用戶交互與任務分發。
  - **結構專家 (`engine.py`):** 純粹的、無副作用的目錄樹生成與註解合併引擎。
  - **路徑專家 (`path.py`):** 健壯的、支持跨平台路徑轉換的 I/O 工具箱。
  - **工人腳本 (`worker.sh`):** 獨立的、負責執行後台文件監控與更新任務的執行單元。

- **✅ 核心工作流:**
  - **名單管理:** 完整支持對 `projects.json` 中的專案進行「增、刪、改、查」的全生命週期管理。
  - **哨兵系統:**
    - 支持對**單個**專案，啟動一個獨立的、背景化的 `inotifywait` 監控進程。
    - 支持通過 PID 檔案，對指定的專案哨兵，進行精準的停止操作。
    - 哨兵在監測到文件系統變化後，能自動觸發 `worker.sh` 執行更新。
  - **自動創建:** `worker.sh` 能在目標 Markdown 文件**不存在**的情況下，自動創建並寫入目錄樹，實現了「零配置」啟動。

- **✅ 診斷與測試:**
  - **診斷專家 (`diagnostics.sh`):** 包含針對各專家和核心流程的單元/集成測試，為專案的健壯性提供了基礎保障。

### ⚠️ 已知限制 (Known Limitations):

- **多哨兵健壯性:** 當前的後台邏輯，其在管理多個並發哨兵時的健壯性**未經嚴格的集成測試**驗證。
- **交互流程:** 菜單交互流程較為僵化，缺乏上下文保留和靈活的返回機制。
- **容錯機制:** 缺乏對「專案目錄失聯」、「孤兒註解」等異常情況的處理。
